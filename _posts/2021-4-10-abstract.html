<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Abstract | Urmila J</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="30 Day Chart Challenge contribution 2021 by Urmila.">
    
    <link rel="preload" href="/30daychartchallenge/assets/css/0.styles.02421d88.css" as="style"><link rel="preload" href="/30daychartchallenge/assets/js/app.bd8bdbcf.js" as="script"><link rel="preload" href="/30daychartchallenge/assets/js/2.2e525a3d.js" as="script"><link rel="preload" href="/30daychartchallenge/assets/js/9.f86c896a.js" as="script"><link rel="prefetch" href="/30daychartchallenge/assets/js/10.bd81b691.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/11.516d0fb2.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/12.0e40a051.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/13.b6687479.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/14.8594d23c.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/15.16fd3ec0.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/16.42cbdc52.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/17.cf2dd924.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/18.0173b01a.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/19.dbd7d002.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/20.75b1ff94.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/21.410a435f.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/22.68fe9605.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/23.3b65595a.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/24.b4a717b2.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/25.6fa1674e.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/26.7b899c36.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/27.256f0c22.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/28.009bc3bd.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/29.7e538b46.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/3.b76cff15.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/30.5f93defd.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/31.af4fe6a2.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/32.ee2bfe20.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/33.4642f797.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/34.7421b3c8.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/35.bdc7d76c.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/36.17997cbd.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/37.5d1689bd.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/38.132f3370.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/39.cd0aef31.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/4.1778016d.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/40.df6cc9a6.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/41.14b50959.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/42.89cbb28c.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/43.926862f5.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/44.94cc6a53.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/5.62b724db.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/6.9c72bc75.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/7.e388c6fd.js"><link rel="prefetch" href="/30daychartchallenge/assets/js/8.38f726ef.js">
    <link rel="stylesheet" href="/30daychartchallenge/assets/css/0.styles.02421d88.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/30daychartchallenge/" class="home-link router-link-active"><!----> <span class="site-name">Urmila J</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/30daychartchallenge/Charts/" class="nav-link">
  Charts
</a></div><div class="nav-item"><a href="/30daychartchallenge/About/" class="nav-link">
  About
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/30daychartchallenge/Charts/" class="nav-link">
  Charts
</a></div><div class="nav-item"><a href="/30daychartchallenge/About/" class="nav-link">
  About
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="statistical-abstract-relating-to-british-india"><a href="#statistical-abstract-relating-to-british-india" class="header-anchor">#</a> Statistical Abstract Relating to British India</h1> <h2 id="week-2-distributions-day-10-abstract"><a href="#week-2-distributions-day-10-abstract" class="header-anchor">#</a> Week 2: Distributions. Day 10: Abstract.</h2> <br> <p>Day 10's prompt was &quot;Abstract&quot; and I was very lucky to come across <a href="https://dsal.uchicago.edu/statistics/" target="_blank" rel="noopener noreferrer">Digital South Asia Library's resource.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> This website has statistical abstract data during British Rule in India. The data includes various things such as imports and exports values, I decided to visualize the value of all exports which includes treasure from British India to other countries by sea during the period 1861-1865.
<br> <br></p> <p>The final chart is below.
<img src="/30daychartchallenge/images/day10/chart-10.png" alt="Statistical Abstract Relating to British India"></p> <br> <h2 id="data"><a href="#data" class="header-anchor">#</a> Data</h2> <p>Data Source: <a href="https://dsal.uchicago.edu/statistics/" target="_blank" rel="noopener noreferrer">Digital South Asia Library's resource<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Data for the chart: Here is the link to the <a href="https://raw.githubusercontent.com/urmilaj/30daycharts2021/gh-pages/data/statisticalAbstract.csv" target="_blank" rel="noopener noreferrer">data.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <br> <h2 id="create-the-chart-with-d3-js"><a href="#create-the-chart-with-d3-js" class="header-anchor">#</a> Create the chart with D3.js</h2> <br> <ul><li>Github link to <a href="https://urmilaj.github.io/30daycharts2021/administration.html" target="_blank" rel="noopener noreferrer">chart<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and code <a href="https://github.com/urmilaj/30daycharts2021/blob/gh-pages/administration.html" target="_blank" rel="noopener noreferrer">repository.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Setup the <a href="/30daychartchallenge/Charts.html">basic html. Follow the instructions here.</a></li> <li>Create the chart.</li></ul> <br> <p>Load the csv data using promise, also convert the data types, since the year and values are in string format, adding a plus symbol converts it to an integer, otherwise this would throw errors when we create scales and axis.</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code>d3<span class="token punctuation">.</span><span class="token function">csv</span><span class="token punctuation">(</span><span class="token string">&quot;data/statisticalAbstract.csv&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        year<span class="token operator">:</span> <span class="token operator">+</span>d<span class="token punctuation">.</span>year<span class="token punctuation">,</span>
        country<span class="token operator">:</span> d<span class="token punctuation">.</span>country<span class="token punctuation">,</span>
        value<span class="token operator">:</span> <span class="token operator">+</span>d<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Set up scales for the beeswarm plot.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> x <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleBand</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">.</span>country<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span>margin<span class="token punctuation">.</span>left<span class="token punctuation">,</span>width<span class="token operator">-</span>margin<span class="token punctuation">.</span>right<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">xAxis</span> <span class="token operator">=</span> <span class="token parameter">g</span> <span class="token operator">=&gt;</span> g<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;transform&quot;</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(0,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>height<span class="token operator">-</span>margin<span class="token punctuation">.</span>right<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>d3<span class="token punctuation">.</span><span class="token function">axisBottom</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> y <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleBand</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span>height<span class="token punctuation">,</span>margin<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">yAxis</span> <span class="token operator">=</span> <span class="token parameter">g</span> <span class="token operator">=&gt;</span> g<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;transform&quot;</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>margin<span class="token punctuation">.</span>left<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,0)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>d3<span class="token punctuation">.</span><span class="token function">axisLeft</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> scaleRadius <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleSqrt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span>d3<span class="token punctuation">.</span><span class="token function">extent</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token parameter">d</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      
<span class="token keyword">const</span> format <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Insert the title for the chart and the axis for the chart.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>svg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">,</span>width<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&quot;Value of exports from British India, to other countries, via sea. (1861-1865)&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;text-wrap&quot;</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;text-anchor&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;middle&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;font-weight&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;bold&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;font-size&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1.4em&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;fill&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;orange&quot;</span><span class="token punctuation">)</span>

svg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>yAxis<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;stroke&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;orange&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;orange&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&quot;font-size&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;15px&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token parameter">g</span> <span class="token operator">=&gt;</span> g<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;.domain&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Appending the circles with radius only and later use d3.forceSimulation to place the circle's cx and cy positions using d3 scales, indicated below on line 8, 11, 12, 18. After the simulation ends and the circles have positioned themselves, then call the tooltips on the circles to place them correctly, indicated on line 20.</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br></div><pre class="language-js"><code><span class="token keyword">const</span> circle <span class="token operator">=</span> svg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;transform&quot;</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>margin<span class="token punctuation">.</span>left<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,120)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">&quot;circle&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;circle&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;fill&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;orange&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;stroke&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;white&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;stroke-width&quot;</span><span class="token punctuation">,</span><span class="token number">1.5</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;r&quot;</span><span class="token punctuation">,</span><span class="token parameter">d</span> <span class="token operator">=&gt;</span> <span class="token function">scaleRadius</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
      
<span class="token keyword">const</span> simulation <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">forceSimulation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">force</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">,</span>d3<span class="token punctuation">.</span><span class="token function">forceX</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=&gt;</span> <span class="token function">x</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>country<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">strength</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">force</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">,</span>d3<span class="token punctuation">.</span><span class="token function">forceY</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=&gt;</span> <span class="token function">y</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">strength</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">force</span><span class="token punctuation">(</span><span class="token string">&quot;charge&quot;</span><span class="token punctuation">,</span>d3<span class="token punctuation">.</span><span class="token function">forceManyBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">strength</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">force</span><span class="token punctuation">(</span><span class="token string">&quot;collide&quot;</span><span class="token punctuation">,</span>d3<span class="token punctuation">.</span><span class="token function">forceCollide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">strength</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">alpha</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>

simulation<span class="token punctuation">.</span><span class="token function">nodes</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;tick&quot;</span><span class="token punctuation">,</span><span class="token parameter">d</span> <span class="token operator">=&gt;</span> circle<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;cx&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span>i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
                               <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;cy&quot;</span><span class="token punctuation">,</span> <span class="token parameter">d</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">,</span> tooltip<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>Create the tooltip function using d3.annotation library. The annotations are created only for value of exports exceeding £ 300,000. So filter for that data and then map it to return tooltip values, use dx and dy (indicated on line 6 and 7) to position the tooltip in an appropriate way without overlapping on an another country.</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">tooltip</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> labels <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">.</span>value<span class="token operator">&gt;</span><span class="token number">300000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span>i</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">{</span>
        x<span class="token operator">:</span>d<span class="token punctuation">.</span>x<span class="token punctuation">,</span>
        y<span class="token operator">:</span>d<span class="token punctuation">.</span>y<span class="token punctuation">,</span>
        dx<span class="token operator">:</span>d<span class="token punctuation">.</span>country<span class="token operator">==</span><span class="token string">&quot;United Kingdom&quot;</span><span class="token operator">?</span><span class="token operator">-</span><span class="token number">25</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">||</span>d<span class="token punctuation">.</span>country<span class="token operator">==</span><span class="token string">&quot;Ceylon&quot;</span><span class="token operator">?</span><span class="token operator">-</span><span class="token number">20</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">||</span>d<span class="token punctuation">.</span>country<span class="token operator">==</span><span class="token string">&quot;Penang, Singapore, and Malacca&quot;</span><span class="token operator">?</span><span class="token number">40</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">||</span>d<span class="token punctuation">.</span>country<span class="token operator">==</span><span class="token string">&quot;Arabian and Persian Gulfs&quot;</span><span class="token operator">?</span><span class="token number">35</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        dy<span class="token operator">:</span>d<span class="token punctuation">.</span>country<span class="token operator">==</span><span class="token string">&quot;United Kingdom&quot;</span><span class="token operator">?</span><span class="token operator">-</span><span class="token number">120</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">||</span>d<span class="token punctuation">.</span>country<span class="token operator">==</span><span class="token string">&quot;China&quot;</span><span class="token operator">?</span><span class="token operator">-</span><span class="token number">110</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">||</span>d<span class="token punctuation">.</span>country<span class="token operator">==</span><span class="token string">&quot;Penang, Singapore, and Malacca&quot;</span><span class="token operator">?</span><span class="token operator">-</span><span class="token number">100</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">||</span>d<span class="token punctuation">.</span>country<span class="token operator">==</span><span class="token string">&quot;Arabian and Persian Gulfs&quot;</span><span class="token operator">?</span><span class="token operator">-</span><span class="token number">130</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token comment">//i%2==0?-45:-120,</span>
        color<span class="token operator">:</span><span class="token string">&quot;orange&quot;</span><span class="token punctuation">,</span>
        note<span class="token operator">:</span><span class="token punctuation">{</span>
          title<span class="token operator">:</span>d<span class="token punctuation">.</span>country<span class="token punctuation">,</span>
          label<span class="token operator">:</span><span class="token string">&quot;£ &quot;</span><span class="token operator">+</span><span class="token function">format</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> type <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">annotationCustomType</span><span class="token punctuation">(</span>
        d3<span class="token punctuation">.</span>annotationCalloutElbow 
        <span class="token punctuation">{</span><span class="token string">&quot;className&quot;</span><span class="token operator">:</span><span class="token string">&quot;custom&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;connector&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;end&quot;</span><span class="token operator">:</span><span class="token string">&quot;dot&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;note&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;lineType&quot;</span><span class="token operator">:</span><span class="token string">&quot;horizontal&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;align&quot;</span><span class="token operator">:</span><span class="token string">&quot;middle&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">let</span> makeAnnot <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">annotation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">textWrap</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">annotations</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span>
    
    svg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;transform&quot;</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>margin<span class="token punctuation">.</span>left<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,120)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>makeAnnot<span class="token punctuation">)</span><span class="token punctuation">;</span>   
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/30daychartchallenge/_posts/2021-4-9-statistics.html" class="prev">
        Statistics
      </a></span> <span class="next"><a href="/30daychartchallenge/_posts/2021-4-11-circular.html">
        Circular
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/30daychartchallenge/assets/js/app.bd8bdbcf.js" defer></script><script src="/30daychartchallenge/assets/js/2.2e525a3d.js" defer></script><script src="/30daychartchallenge/assets/js/9.f86c896a.js" defer></script>
  </body>
</html>
